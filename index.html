<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <meta charset="utf-8">
  <title>Richard's Webpage</title>
  <meta name="viewport" content="width=960">
  <meta name="keywords" content="google,bouncing balls,html5" />
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script src="./dataURI.js"></script>
  <link href="main.css" rel="stylesheet">
  <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body>
  <noscript><h1>We need javascript to view my page.</h1></noscript>
  <canvas id="c" onmousemove="mouse_moved(event)"></canvas>
  
<<<<<<< HEAD
<div class="content">
  <h1 id="head" class="content__heading">Richard Higgins</h1>
  <p id="blurb" class="content__teaser">Hi, I like ideas, thinking, and reading. I like programming because I can make what I imagine.</p>
  <button id="mute" class="content__cta" style="cursor:pointer;">Listen In</button><br><br>
  <a href="/resume" id="resume" class="content__cta">Resume</a><br><br>
  <audio id="my-audio" src="media/stillness_in_woe.mp3" autoplay muted loop></audio>
</div><!-- /content -->

<video id="my-video" class="video" autoplay muted loop>
  <source src="media/sunrise.mp4" type="video/mp4">
</video><!-- /video -->

<script>
(function() {
  /**
   * Video element
   * @type {HTMLElement}
   */
  var video = document.getElementById("my-video");
  video.playbackRate = 1.71;
  var audio = document.getElementById("my-audio");
=======
  <script>
    // Page Canvas
    var canvas = document.getElementById('c');
    var context = canvas.getContext('2d');
    var dataURL = "0";

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    var img = new Image;
    img.onload = function(){
      context.drawImage(img, (canvas.width-img.width)/2, (canvas.height-img.height)/2);
    };
    img.src = dataURI;
>>>>>>> master

    // Temporary Drawing Canvas
    var tempCanvas = document.createElement("canvas");
    var tCtx = tempCanvas.getContext("2d");

<<<<<<< HEAD
  /**
   * Check if video can play, and play it
   */
  var started = false;
  video.addEventListener( "canplay", function() {
    //video.play();
    var i = 0;
    if (started == false) {
      var colorChanger = setInterval(function () {
        var head = document.getElementById("head");
        var blurb = document.getElementById("blurb");
        var color = 9;
        head.style.color = "#"+(color-(~~(i/10)))+(color-(i%10))+(color-(~~(i/10)))+(color-(i%10))+(color-(~~(i/10)))+(color-(i%10));
        blurb.style.color = "#"+(color-(~~(i/10)))+(color-(i%10))+(color-(~~(i/10)))+(color-(i%10))+(color-(~~(i/10)))+(color-(i%10));
        i = i + 1;
        if (i >= 99) {
          clearInterval(colorChanger);
        }
      }, 400);
      started = true;
    }
  });
  /*
  audio.addEventListener( "canplay", function() {
    audio.play();
  });*/
})();
</script>
=======
    tempCanvas.width = 50;
    tempCanvas.height = 50;

    // Keeping Track of Mouse Position 
    var x = 100;
    var y = 100;

    function mouse_moved(event) {
      x = event.clientX;
      y = event.clientY;
    }
>>>>>>> master

    // Posting every second
    setInterval(function() {
      // method to be executed;
      // style_it(canvas.toDataURL());
      var start_x = x-25;
      var start_y = y-25;
      console.log(start_x + " " + start_y);
      var crop = get_crop(start_x, start_y);
      style_it(crop, start_x, start_y);
    }, 5000);

    // Getting a Crop from the Canvas
    function get_crop(oldx, oldy) {
      //call its drawImage() function passing it the source canvas directly
      tCtx.clearRect(0, 0, tempCanvas.width, tempCanvas.height);
      tCtx.drawImage(canvas, -oldx, -oldy);
      return tempCanvas.toDataURL();
    }

    // Style Request
    function style_it(image, oldx, oldy){
        console.log("ajax start!");
        $.ajax({
         startx : oldx,
         starty : oldy,
         type : "POST",
         url  : "https://17rp0ab6j4.execute-api.us-east-1.amazonaws.com/dev/ping",
         crossDomain: true,
         contentType: 'application/json',
         data: JSON.stringify({"image": image}),
         dataType: 'json',
         error: function(xhr, error){
                console.log("broke image");
                console.log(xhr);
                console.log(error);
         },
         success: function(result) { 
            console.log("new image");
            var img = document.createElement("img");
            img.src = "data:image/jpeg;base64," + result;
            context.drawImage(img, this.startx, this.starty);
         }
        });
    }
</script>
</body>
</html>
